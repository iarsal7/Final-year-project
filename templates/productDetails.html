{% extends 'test.html' %}
{% load static %}
{% block stylesheet %}

<link rel="stylesheet" type="text/css" href="{% static 'one/plugins/OwlCarousel2-2.2.1/owl.carousel.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'one/plugins/OwlCarousel2-2.2.1/owl.theme.default.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'one/plugins/OwlCarousel2-2.2.1/animate.css' %}">
{% comment %} <link rel="stylesheet" type="text/css" href="{% static 'one/styles/product_styles.css' %}"> {% endcomment %}
<link rel="stylesheet" type="text/css" href="{% static 'one/styles/product_responsive' %}">


{% endblock stylesheet %}


{% block content %}

<!-- Single Product -->

	<div class="single_product">
		<div class="container">
			<div class="row">

				<!-- Images -->
				<div class="col-lg-2 order-lg-1 order-2">
					 
					<ul class="image_list">
					{% for p in photos %}
						
						<li data-image="{{ p.images.url}}"><img src="{{ p.images.url}}" alt=""></li>
						
						
					{% endfor %}
					</ul>
					
				</div>

				<!-- Selected Image -->
				<div class="col-lg-5 order-lg-2 order-1">
					<div class="image_selected"><img src="{{ product.image.url}}" alt=""></div>
				</div>

				<!-- Description -->
				<div class="col-lg-5 order-3">
					<div class="product_description">
						<div class="product_category">'{{product.category.name}}'</div>
						<div class="product_name">{{product.title}}</div>
						<div class="rating_r rating_r_4 product_rating"><i></i><i></i><i></i><i></i><i></i></div>
						<div class="product_text"><p>{{product.description}}</p></div>
						<div class="order_info d-flex flex-row">
							<form method="POST" action='{% url 'cart' %}' class="form form-product-ajax"> {% csrf_token %}
								<input type="hidden"  name="product_id" value="{{product.id}}" >
								<div class="clearfix" style="z-index: 1000;">

									<!-- Product Quantity -->
									<div style="background-color: #0e8ce4;" class=" product_quantity clearfix" >
										<span style="font-size: 18px; font-weight: 400; line-height: 48px; color: #FFFFFF;" >Quantity: </span>
										<input type="text" style="font-size: 18px; font-weight: 400; line-height: 48px; background-color:#0e8ce4 ; color: #FFFFFF;"  id="quantity_input"  pattern="[0-9]*" name="quantity" value="1">
										<div class="button quantity_buttons ml-0" style="background-color: 0e8ce4;">
											<div id="quantity_inc_button" class="quantity_inc quantity_control "><i style="color: #FFFFFF;" class="fas fa-chevron-up"></i></div>
											<div id="quantity_dec_button" class="quantity_dec quantity_control"> <i style="color: #FFFFFF;" class="fas fa-chevron-down"></i></div>
										</div>
									</div>

									<!-- Product Color -->
									<ul class="product_color">
										<li>
											<span>Color: </span>
											<div class="color_mark_container"><div id="selected_color" class="color_mark"></div></div>
											<div class="color_dropdown_button"><i class="fas fa-chevron-down"></i></div>

											<ul class="color_list">
												<li><div class="color_mark" style="background: #999999;"></div></li>
												<li><div class="color_mark" style="background: #b19c83;"></div></li>
												<li><div class="color_mark" style="background: #000000;"></div></li>
											</ul>
										</li>
									</ul>

								</div>

								<div class="product_price">Rs {{product.price|floatformat:"0" }}</div>
								<div class="button_container">
									<button type="submit"  name="submit" value="submit" class="button cart_button">Add to Cart</button>
									
									<div class="product_fav"><i class="fas fa-heart"></i></div>
								</div>
								
							</form>
						</div>
					</div>
				</div>

			</div>
		</div>
	</div>

{% endblock content %}
{% block javascript %}
<script src="{% static 'one/plugins/OwlCarousel2-2.2.1/owl.carousel.js' %}"></script>
<script src="{% static 'one/js/product_custom.js' %}"></script>
<script>

    var productForm = $(".form-product-ajax") //add to cart
	
	productForm.submit(function(event){ã€€
		debugger;
		event.preventDefault();
		
        var thisForm = $(this)
        var action= thisForm.attr("action");
        var method = thisForm.attr("method");
        var formData = thisForm.serialize();
	

      $.ajax({
        url: action,
        method: method,
        data: formData,
					
        success: function(data){

        var cartcount= $(".cart-count") //cart-count is span field in base.html
        cartcount.text(data.cartCount) //cartCount is jsonResponse in views

        },

      error: function(errorData){
        console.log("error")
        console.log(errorData)
      }

      })

        })



</script>

{% endblock javascript %}